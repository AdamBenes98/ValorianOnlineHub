<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>News Feed</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
/* ---------- CSS VARIABLES ---------- */
:root{
  --bg:#000;
  --card:#0a0a0a;
  --border:#222;
  --accent:#dc143c;
  --text:#fff;
  --sub:#aaa;
  --gap:1.2rem;
  --radius:8px;
  --font:'Inter',system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
}
/* ---------- RESET ---------- */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
body{background:var(--bg);color:var(--text);font-family:var(--font);line-height:1.4}
a{color:var(--accent);text-decoration:none}
img{max-width:100%;display:block;border-radius:var(--radius)}
/* ---------- HEADER ---------- */
header{background:var(--card);border-bottom:2px solid var(--accent);padding:.8rem 1.2rem;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:10}
header h1{font-size:1.3rem;letter-spacing:.5px}
#backBtn{background:transparent;border:1px solid var(--accent);color:var(--accent);padding:.4rem .8rem;border-radius:var(--radius);cursor:pointer;font-weight:bold;transition:.2s}
#backBtn:hover{background:var(--accent);color:#fff}
/* ---------- MAIN ---------- */
main{max-width:680px;margin:auto;padding:1rem 1rem 4rem}
/* ---------- NEW POST ---------- */
.new-post{background:#111;border:1px solid var(--border);border-radius:var(--radius);padding:1rem;margin-bottom:1.2rem}
.new-post h2{margin-bottom:.6rem;font-size:1.1rem}
.new-post input[type=text],.new-post textarea,.new-post select{width:100%;padding:.5rem;margin-top:.4rem;background:#1a1a1a;border:1px solid #333;border-radius:4px;color:var(--text);font-family:inherit}
.new-post textarea{resize:vertical;min-height:70px}
.new-post input[type=file]{margin-top:.4rem}
.font-row{display:flex;gap:.5rem;margin-top:.4rem;flex-wrap:wrap}
.font-row select,.font-row input{flex:1}
.new-post button{margin-top:.6rem;padding:.5rem 1rem;border:none;border-radius:4px;background:var(--accent);color:#fff;font-weight:bold;cursor:pointer}
/* ---------- POSTS ---------- */
.post{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:1rem;margin-bottom:1rem;position:relative;transition:.2s}
.post.pinned{border-color:var(--accent)}
.post.highlighted{background:#1c1c1c;border:1px solid #ffd700}
.post-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:.4rem}
.post-header .name{font-weight:bold}
.post-header .time{font-size:.75rem;color:var(--sub)}
.post-body{margin:.5rem 0;word-break:break-word}
.post-body .attachment{margin-top:.5rem}
.post-actions{display:flex;gap:1rem;font-size:.8rem;margin-top:.6rem}
.post-actions span{cursor:pointer;user-select:none;display:flex;align-items:center;gap:.3rem;color:var(--sub);transition:.2s}
.post-actions span:hover{color:var(--text)}
.post-actions .options{position:relative}
.post-actions .options-menu{display:none;position:absolute;top:1.4rem;right:0;background:#1a1a1a;border:1px solid #444;border-radius:4px;overflow:hidden;z-index:5}
.post-actions .options-menu a{display:block;padding:.4rem .7rem;font-size:.75rem;color:var(--text);white-space:nowrap}
.post-actions .options-menu a:hover{background:#222}
/* ---------- MODALS ---------- */
.modal{display:none;position:fixed;inset:0;background:#0008;z-index:20;align-items:center;justify-content:center}
.modal.active{display:flex}
.modal-content{background:#111;border:1px solid #444;border-radius:var(--radius);padding:1.2rem;min-width:260px}
.modal-content h3{margin-bottom:.6rem}
.modal-content input{width:100%;padding:.5rem;margin:.4rem 0;background:#1a1a1a;border:1px solid #333;border-radius:4px;color:var(--text)}
.modal-buttons{display:flex;gap:.6rem;margin-top:.6rem}
.modal-buttons button{flex:1;padding:.5rem;border:none;border-radius:4px;cursor:pointer;font-weight:bold}
.modal-buttons .ok{background:var(--accent);color:#fff}
.modal-buttons .cancel{background:#333;color:#fff}
/* ---------- RESPONSIVE ---------- */
@media(max-width:500px){
  header h1{font-size:1.1rem}
  .font-row{flex-direction:column}
}
</style>
</head>
<body>

<header>
  <h1>Official News Feed</h1>
  <a href="index.html"><button id="backBtn">Back to Main Page</button></a>
</header>

<main>
  <!-- NEW POST -->
  <section class="new-post">
    <h2>Share Update</h2>
    <input type="text" id="username" placeholder="Your name">
    <textarea id="message" placeholder="What's happening?"></textarea>
    <input type="file" id="fileInput" accept="image/*,.pdf">
    <div class="font-row">
      <select id="fontSize"><option value="">Font size</option><option>12px</option><option>14px</option><option>16px</option><option>18px</option><option>20px</option></select>
      <input type="color" id="fontColor" value="#ffffff">
      <select id="fontFamily"><option value="">Font family</option><option>Inter</option><option>Roboto</option><option>Lato</option><option>Georgia</option><option>Courier</option></select>
    </div>
    <button id="postBtn">Post</button>
  </section>

  <!-- FEED -->
  <div id="feed"></div>
</main>

<!-- MODALS -->
<div id="loginModal" class="modal">
  <div class="modal-content">
    <h3>Admin Login</h3>
    <input id="loginUser" placeholder="Username">
    <input id="loginPass" type="password" placeholder="Password">
    <div class="modal-buttons">
      <button class="ok" id="loginOk">Login</button>
      <button class="cancel" id="loginCancel">Cancel</button>
    </div>
  </div>
</div>

<div id="editModal" class="modal">
  <div class="modal-content">
    <h3>Edit Post</h3>
    <textarea id="editText"></textarea>
    <div class="modal-buttons">
      <button class="ok" id="editOk">Save</button>
      <button class="cancel" id="editCancel">Cancel</button>
    </div>
  </div>
</div>

<script>
/* ---------- UTILS ---------- */
const qs=s=>document.querySelector(s);
const qsa=s=>[...document.querySelectorAll(s)];
const genId=_=>'_'+Math.random().toString(36).substr(2,9);
const timeAgo=t=>{
  const s=Math.floor((Date.now()-t)/1000);
  if(s<60)return s+'s';
  const m=Math.floor(s/60);
  if(m<60)return m+'m';
  const h=Math.floor(m/60);
  if(h<24)return h+'h';
  const d=Math.floor(h/24);
  return d+'d';
};
/* ---------- STATE ---------- */
let posts=JSON.parse(localStorage.getItem('newsPosts')||'[]');
let isAdmin=false;
let currentEditId=null;
let draft=JSON.parse(localStorage.getItem('newsDraft')||'{}');
/* ---------- DOM ---------- */
const feed=qs('#feed');
const username=qs('#username');
const message=qs('#message');
const fileInput=qs('#fileInput');
const fontSize=qs('#fontSize');
const fontColor=qs('#fontColor');
const fontFamily=qs('#fontFamily');
const postBtn=qs('#postBtn');
const loginModal=qs('#loginModal');
const editModal=qs('#editModal');
/* ---------- LOAD DRAFT ---------- */
if(draft.username)username.value=draft.username;
if(draft.message)message.value=draft.message;
if(draft.fontSize)fontSize.value=draft.fontSize;
if(draft.fontColor)fontColor.value=draft.fontColor;
if(draft.fontFamily)fontFamily.value=draft.fontFamily;
/* ---------- SAVE DRAFT ---------- */
const saveDraft=_=>{
  localStorage.setItem('newsDraft',JSON.stringify({
    username:username.value,
    message:message.value,
    fontSize:fontSize.value,
    fontColor:fontColor.value,
    fontFamily:fontFamily.value
  }));
};
[username,message,fontSize,fontColor,fontFamily].forEach(el=>el.addEventListener('input',saveDraft));
/* ---------- RENDER ---------- */
function render(){
  const sorted=[...posts].sort((a,b)=>{
    if(a.pinned&&!b.pinned)return -1;
    if(!a.pinned&&b.pinned)return 1;
    return b.ts-a.ts;
  });
  feed.innerHTML='';
  sorted.forEach(p=>{
    const div=document.createElement('div');
    div.className='post'+(p.pinned?' pinned':'')+(p.highlighted?' highlighted':'');
    div.dataset.id=p.id;
    const attachment=p.attachment?`<div class="attachment">${p.attachment.type.startsWith('image')?`<img src="${p.attachment.url}">`:`<a href="${p.attachment.url}" target="_blank">üìÑ ${p.attachment.name}</a>`}</div>`:'';
    div.innerHTML=`
      <div class="post-header">
        <span class="name">${escape(p.username)} ${p.admin?'<span class="badge">ADMIN</span>':''}</span>
        <span class="time">${timeAgo(p.ts)}</span>
      </div>
      <div class="post-body" style="${p.style||''}">${escape(p.message)}</div>
      ${attachment}
      <div class="post-actions">
        <span data-act="like">üëç ${p.likes||0}</span>
        <span data-act="dislike">üëé ${p.dislikes||0}</span>
        <span data-act="share">üîó Share</span>
        <span class="options">
          <span data-act="opts">‚ãÆ</span>
          <div class="options-menu" style="display:none">
            <a href="#" data-act="share-link">Copy link</a>
            <a href="#" data-act="report">Report</a>
            ${isAdmin?`
            <a href="#" data-act="edit">Edit</a>
            <a href="#" data-act="pin">${p.pinned?'Unpin':'Pin'}</a>
            <a href="#" data-act="highlight">${p.highlighted?'Un-highlight':'Highlight'}</a>
            <a href="#" data-act="delete">Delete</a>
            `:'<a href="#" data-act="admin">Admin Features</a>'}
          </div>
        </span>
      </div>
    `;
    feed.appendChild(div);
  });
  attachEvents();
}
function attachEvents(){
  qsa('.post-actions span[data-act]').forEach(btn=>{
    btn.onclick=e=>{
      e.stopPropagation();
      const act=btn.dataset.act;
      const postEl=btn.closest('.post');
      const id=postEl.dataset.id;
      const p=posts.find(x=>x.id===id);
      if(!p)return;
      if(act==='like'){p.likes=(p.likes||0)+1;save();render();}
      if(act==='dislike'){p.dislikes=(p.dislikes||0)+1;save();render();}
      if(act==='share'){copyLink(id);}
      if(act==='opts'){toggleMenu(btn);}
      if(act==='share-link'){copyLink(id);closeMenus();}
      if(act==='report'){alert('Reported');closeMenus();}
      if(act==='admin'){openLogin();closeMenus();}
      if(act==='edit'){openEdit(id);closeMenus();}
      if(act==='delete'){posts=posts.filter(x=>x.id!==id);save();render();}
      if(act==='pin'){p.pinned=!p.pinned;save();render();}
      if(act==='highlight'){p.highlighted=!p.highlighted;save();render();}
    }
  });
}
function toggleMenu(btn){
  const menu=btn.querySelector('.options-menu');
  const open=menu.style.display==='block';
  closeMenus();
  menu.style.display=open?'none':'block';
}
function closeMenus(){qsa('.options-menu').forEach(m=>m.style.display='none');}
window.addEventListener('click',closeMenus);
/* ---------- POST ---------- */
postBtn.onclick=_=>{
  if(!username.value.trim()||!message.value.trim())return alert('Fill name and message');
  const file=fileInput.files[0];
  const reader=new FileReader();
  reader.onload=e=>{
    const attachment=file?{name:file.name,type:file.type,url:e.target.result}:null;
    const style=`${fontSize.value?`font-size:${fontSize.value};`:''}${fontColor.value?`color:${fontColor.value};`:''}${fontFamily.value?`font-family:${fontFamily.value},sans-serif;`:''}`;
    posts.unshift({
      id:genId(),
      username:username.value.trim(),
      message:message.value.trim(),
      attachment,
      style,
      ts:Date.now(),
      admin:isAdmin,
      likes:0,
      dislikes:0,
      pinned:false,
      highlighted:false
    });
    save();
    // reset
    username.value=message.value='';fileInput.value='';
    fontSize.value=fontColor.value=fontFamily.value='';
    localStorage.removeItem('newsDraft');
    render();
  };
  if(file)reader.readAsDataURL(file);else reader.onload({target:{result:null}});
};
/* ---------- SAVE / COPY ---------- */
function save(){localStorage.setItem('newsPosts',JSON.stringify(posts));}
function copyLink(id){
  const url=`${location.origin}${location.pathname}#${id}`;
  navigator.clipboard.writeText(url).then(_=>alert('Link copied!'));
}
/* ---------- LOGIN ---------- */
function openLogin(){loginModal.classList.add('active');qs('#loginUser').focus();}
qs('#loginCancel').onclick=_=>loginModal.classList.remove('active');
qs('#loginOk').onclick=_=>{
  const u=qs('#loginUser').value.trim();
  const p=qs('#loginPass').value;
  if(u==='master'&&p==='M4sterP@ss'){isAdmin=true;loginModal.classList.remove('active');render();alert('Admin mode unlocked');}
  else alert('Wrong credentials');
  qs('#loginPass').value='';
};
/* ---------- EDIT ---------- */
function openEdit(id){
  const p=posts.find(x=>x.id===id);
  if(!p)return;
  currentEditId=id;
  qs('#editText').value=p.message;
  editModal.classList.add('active');
}
qs('#editCancel').onclick=_=>editModal.classList.remove('active');
qs('#editOk').onclick=_=>{
  const p=posts.find(x=>x.id===currentEditId);
  if(p){p.message=qs('#editText').value;save();render();}
  editModal.classList.remove('active');
};
/* ---------- INIT ---------- */
render();
/* ---------- HASH JUMP ---------- */
if(location.hash){
  const id=location.hash.slice(1);
  setTimeout(_=>qs(`[data-id="${id}"]`)?.scrollIntoView({behavior:'smooth'}),300);
}
</script>
</body>
</html>
