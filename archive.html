<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Vote Archive</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
/* ----------  red-theme archive (matches voter page)  ---------- */
:root{
  --bg:#111;
  --text:#ffffff;
  --sub:#999;
  --green:#00c853;   /* YES */
  --red:#ff5252;     /* NO  */
  --radius:4px;
  --font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
}
body{margin:0;background:var(--bg);color:var(--text);font-family:var(--font);padding:2rem}
a{color:var(--red)}
.small{font-size:.8rem;color:var(--sub)}
h1{margin:0 0 1rem}
.poll{background:#1e1e1e;padding:1rem;border-radius:8px;margin-bottom:1rem}
.barWrap{height:20px;background:var(--red);border-radius:var(--radius);overflow:hidden;margin:.5rem 0}
.bar{height:100%;background:var(--green);transition:width .3s}
</style>
</head>
<body>
<div class="small"><a href="index.html">← Back to main page</a></div>
<h1>Past Referenda</h1>
<div id="list"></div>

<script>
/*  key must match the voter script  */
const ARCHIVE_KEY = 'archive';

function load(k,def=[]){try{return JSON.parse(localStorage.getItem(k))}catch{return def}}

const list = load(ARCHIVE_KEY);
const box  = document.getElementById('list');

if (!list.length){
  box.innerHTML = '<p>No archived votes yet.</p>';
}else{
  list.forEach(p=>{
    const yesP = (100*p.results.yes/(p.results.total)||0).toFixed(1);
    const noP  = (100*p.results.no /(p.results.total)||0).toFixed(1);
    const div  = document.createElement('div');
    div.className = 'poll';
    div.innerHTML = `
      <h3>${p.title}</h3>
      <p class="small">Ended ${new Date(p.end).toLocaleString()}</p>
      <div class="barWrap"><div class="bar" style="width:${yesP}%"></div></div>
      <p class="small">${p.results.yes} Yes (${yesP}%) · ${p.results.no} No (${noP}%)</p>
    `;
    box.appendChild(div);
  });
}
</script>
</body>
</html>
